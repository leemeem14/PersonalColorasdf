<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>퍼스널 컬러 분석 결과</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <style>
        body {
            margin: 0;
            font-family: sans-serif;
            background-image: url("/images/mainpage.png");
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            min-height: 100vh;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
        }
        .top img {
            margin-top: 10px;
            width: 100%;
            max-height: 50vh;
            object-fit: cover;
            /*margin-bottom: 5px;*/
            border-radius: 4px;
            border: 2px solid black;

            /* 이미지가 눈송이보다 위에 오도록 */
            position: relative;
            z-index: 1;
        }
        #selectedColorBox {
            display: none;
            width: 100%;
            height: 100px;
            border-radius: 4px;
            border: 2px solid black;
            position: relative;
            z-index: 1;
        }
        h1, p { text-align: center; margin: 5px 0; }
        .btn-group { margin-top: 20px; }
        .btn-group button {
            margin: 0 10px;
            padding: 10px 20px;
            border-radius: 4px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
        }
        .prev-btn {
            background: #fff; color: #000; border: 2px solid #000;
        }
        .prev-btn:hover { background: #000; color: #fff; }
        .next-btn {
            background: #000; color: #fff;
        }
        .next-btn:hover { background: #fff; color: #000; border:2px solid #000; }
        button::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%; left: 50%;
            transform: translateX(-50%);
            background: #555; color: #fff;
            padding: 5px 10px; border-radius: 4px;
            font-size:12px; white-space:nowrap;
            opacity:0; visibility:hidden;
            transition:0.3s; z-index:1000;
        }
        button:hover::after { opacity:1; visibility:visible; }
        .snowflake {
            position: fixed;
            top: -10px;
            font-size: 20px;
            animation: fall linear infinite;

            /* 이미지보다 뒤로 가도록 */
            z-index: 0;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(360deg); }
        }
        .color-swatch {
            width: 50px;
            height: 50px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: transform .2s;
        }
        .color-swatch:hover {
            transform: scale(1.1);
            border-color: #aaa;
        }
        .result-box {
            background-color: #f4f4f4;
            border: 1px solid #ccc;
            padding: 20px;
            width: 80%;
            max-width: 600px;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            font-size: 14px;
            color: #333;
            position: relative;
            z-index: 1;
        }
        .result-box p {
            margin: 10px 0;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="top">
        <img id="resultImage" th:src="@{'/files/' + ${analysis.storedFileName}}" alt="분석된 이미지">
        <div id="selectedColorBox"></div>
    </div>
    <div class="result-box">
        <h1 th:text="${analysis.colorType.displayName} + ' - 당신의 퍼스널 컬러입니다'" id="resultTitle"></h1>
        <p th:text="${description}"></p>
        <p>신뢰도: <span th:text="${confidence}"></span>%</p>
        <div th:if="${recommendations}">
            <h3>추천 색상:</h3>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <div th:each="color : ${recommendations}"
                     class="color-swatch"
                     th:title="${color}"
                     style="width: 50px; height: 50px; border:1px solid #ddd; border-radius:4px;"
                     th:style="'background-color:' + ${color}">
                </div>
            </div>
        </div>
    </div>
    <div class="btn-group">
        <button class="prev-btn"
                th:onclick="|window.location.href='@{/upload}'|"
                data-tooltip="사진 업로드로 돌아가기">
            이전
        </button>
        <button class="next-btn" onclick="location.href='1.html'" data-tooltip="쇼핑 페이지로 이동">다음</button>
    </div>
</div>
<script>
    window.onload = function() {
        // color-swatch 클릭 이벤트
        document.querySelectorAll('.color-swatch').forEach(function(swatch) {
            swatch.addEventListener('click', function() {
                var colorValue = swatch.style.backgroundColor;
                var colorBox = document.getElementById('selectedColorBox');
                colorBox.style.backgroundColor = colorValue;
                colorBox.style.display = 'block';
            });
        });

        // 눈송이 애니메이션
        const colors = ["#FFB6C1", "#FF69B4", "#87CEEB", "#8A2BE2", "#7FFFD4", "#FFD700", "#FFA07A"];
        const symbols = ["❄", "♥", "✿", "★"];
        function createSnowflake() {
            const flake = document.createElement("div");
            let fallSpeed = 2;
            flake.className = "snowflake";
            flake.style.left = Math.random() * window.innerWidth + "px";
            flake.style.animationDuration = 3 + Math.random() * 5 + "s";
            flake.style.color = colors[Math.floor(Math.random()*colors.length)];
            flake.textContent = symbols[Math.floor(Math.random()*symbols.length)];
            document.body.appendChild(flake);
            setTimeout(() => flake.remove(), 5000);
        }
        setInterval(createSnowflake, 500);
    };
</script>
</body>
</html>


