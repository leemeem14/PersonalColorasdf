<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>í¼ìŠ¤ë„ ì»¬ëŸ¬ ë¶„ì„ ê²°ê³¼</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-image: url("/images/mainpage.png");
            background-size: cover;
            background-attachment: fixed;
            min-height: 100vh;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1, p { text-align: center; margin: 8px 0; color: #333; }
        #stage {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-bottom: 30px;
            border: 3px solid #333;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        #resultImage {
            display: block;
            width: 100%;
            height: auto;
            border-radius: 9px;
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            #stage { max-width: 100%; }
            .chart-grid { grid-template-columns: 1fr; }
            .info-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
        }

        .color-swatch {
            width: 50px;
            height: 50px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .color-swatch:hover { transform: scale(1.1); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .color-swatch.selected { border: 3px solid #333; box-shadow: 0 0 10px rgba(0,0,0,0.5); transform: scale(1.15); }
        .color-swatch.selected::after {
            content: 'âœ“';
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: white; font-weight: bold; font-size: 16px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .charts-section { width: 100%; max-width: 800px; margin: 30px 0; padding: 20px; background: rgba(255, 255, 255, 0.9); border-radius: 10px; }
        .chart-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .chart-container {
            background: white; border-radius: 8px; padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); height: 300px; min-height: 280px;
        }
        canvas { width: 100% !important; height: 220px !important; min-height: 200px; }

        .recommendations-section { margin: 20px 0; padding: 15px; background: rgba(255, 255, 255, 0.8); border-radius: 10px; }
        .recommendations-section h3 { text-align: center; color: #333; margin-bottom: 15px; }
        .color-swatches { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }

        #canvasOverlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; border-radius: 4px; }

        /* í† ê¸€ ê³µí†µ */
        .hidden { display: none; }
        .toggle-buttons {
            display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-top: 16px;
        }
        .toggle-buttons button, .close-btn {
            padding: 10px 16px; border-radius: 8px; font-weight: 600; cursor: pointer; border: 2px solid #333;
            background: #fff; color: #333; transition: all .2s ease;
        }
        .toggle-buttons button:hover, .close-btn:hover { background: #333; color: #fff; }

        /* í†¤ ì„¤ëª… ë°•ìŠ¤ */
        #toneDescriptionBox { background: #fff; border-radius: 10px; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,.08); }
        #toneDescriptionBox h3 { margin-top: 8px; }
        #toneSection h2 { text-align: center; margin-bottom: 16px; color: #333; }
    </style>
</head>
<body>
<div class="container">
    <div id="stage">
        <img id="resultImage" th:src="@{'/files/' + ${analysis.storedFileName}}" alt="ë¶„ì„ ì´ë¯¸ì§€"/>
        <canvas id="canvasOverlay"></canvas>
    </div>

    <div class="result-header" style="text-align: center; margin-bottom: 16px; padding: 20px; background: rgba(255, 255, 255, 0.9); border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h1 style="margin: 0 0 10px 0; color: #333; font-size: 28px;" th:text="${analysis.colorType.displayName} + ' - ë‹¹ì‹ ì˜ í¼ìŠ¤ë„ ì»¬ëŸ¬ì…ë‹ˆë‹¤'"></h1>
        <p style="margin: 0; color: #666; font-size: 16px; line-height: 1.5;" th:text="${description}"></p>
        <div style="margin-top: 15px; padding: 10px; background: rgba(54, 162, 235, 0.1); border-radius: 8px; border-left: 4px solid #36A2EB;">
            <p style="margin: 0; color: #333; font-weight: bold; font-size: 14px;">
                ì‹ ë¢°ë„: <span th:text="${confidence} + '%'"></span>
                <span style="color: #666; font-weight: normal;">(í’ˆì§ˆ: <span th:text="${qualityLevel}"></span>)</span>
            </p>
        </div>
    </div>

    <!-- ì¶”ì²œ ìƒ‰ìƒ -->
    <div th:if="${recommendations != null && !recommendations.isEmpty()}" class="recommendations-section">
        <h3>ğŸ¨ ì¶”ì²œ ìƒ‰ìƒ</h3>
        <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">ì•„ë˜ ìƒ‰ìƒì„ í´ë¦­í•˜ì—¬ ì˜· ìƒ‰ìƒ ë¯¸ë¦¬ë³´ê¸°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”</p>
        <div class="color-swatches">
            <div th:each="color : ${recommendations}"
                 class="color-swatch"
                 th:style="'background-color:' + ${color}"
                 th:data-color="${color}"
                 th:title="'í´ë¦­í•˜ì—¬ ' + ${color} + ' ìƒ‰ìƒ ì ìš©'">
            </div>
        </div>
        <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255, 255, 255, 0.7); border-radius: 8px;">
            <p style="margin: 0; color: #666; font-size: 12px;">ğŸ’¡ íŒ: ì´ë¯¸ì§€ ìœ„ë¥¼ í´ë¦­í•œ í›„ ì¶”ì²œ ìƒ‰ìƒì„ ì„ íƒí•˜ë©´ ì‹¤ì œ ìƒ‰ìƒ ì ìš© íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
        </div>
    </div>

    <!-- ë³´ê¸°/ë‹«ê¸° í† ê¸€ ë²„íŠ¼ -->
    <div class="toggle-buttons">
        <button id="openDetailBtn" type="button">ìƒì„¸ ë¶„ì„ ë³´ê¸°</button>
        <button id="closeDetailBtn" type="button" class="hidden">ìƒì„¸ ë¶„ì„ ë‹«ê¸°</button>
        <button id="openToneBtn" type="button"> ì¶”ì²œ ë³´ê¸°</button>
        <button id="closeToneBtn" type="button" class="hidden"> ì¶”ì²œ ë‹«ê¸°</button>
    </div>

    <!-- ìƒì„¸ ë¶„ì„: ì´ˆê¸° ìˆ¨ê¹€ -->
    <section id="detailSection" class="charts-section hidden">
        <h2 style="text-align: center; margin-bottom: 30px; color: #333;">ğŸ“Š ìƒì„¸ ë¶„ì„ ê²°ê³¼</h2>
        <div class="chart-grid">
            <div class="chart-container">
                <h4 style="text-align: center; margin-bottom: 15px; color: #555;">ì‹ ë¢°ë„ ë¶„ì„</h4>
                <canvas id="confidenceChart" width="300" height="220"></canvas>
            </div>
            <div class="chart-container">
                <h4 style="text-align: center; margin-bottom: 15px; color: #555;">í¼ìŠ¤ë„ ì»¬ëŸ¬ íƒ€ì… ë¹„êµ</h4>
                <canvas id="typeComparisonChart" width="300" height="220"></canvas>
            </div>
        </div>

        <div class="analysis-details" style="margin-top: 30px; padding: 20px; background: rgba(255, 255, 255, 0.8); border-radius: 10px;">
            <h3 style="text-align: center; margin-bottom: 20px; color: #333;">ë¶„ì„ ìƒì„¸ ì •ë³´</h3>
            <div class="info-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div class="info-item" style="padding: 15px; background: white; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="margin: 0 0 10px 0; color: #666; font-size: 14px;">ì‹ ë¢°ë„</h4>
                    <p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;" th:text="${confidence} + '%'"></p>
                    <p style="margin: 5px 0 0 0; font-size: 12px; color: #888;" th:text="'í’ˆì§ˆ: ' + ${qualityLevel}"></p>
                </div>
                <div class="info-item" style="padding: 15px; background: white; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="margin: 0 0 10px 0; color: #666; font-size: 14px;">ë¶„ì„ íƒ€ì…</h4>
                    <p style="margin: 0; font-size: 18px; font-weight: bold; color: #333;" th:text="${analysis.colorType.displayName}"></p>
                </div>
                <div class="info-item" style="padding: 15px; background: white; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="margin: 0 0 10px 0; color: #666; font-size: 14px;">ì¶”ì²œ ìƒ‰ìƒ ìˆ˜</h4>
                    <p style="margin: 0; font-size: 24px; font-weight: bold; color: #333;" th:text="${#lists.size(recommendations)} + 'ê°œ'"></p>
                </div>
                <div class="info-item" style="padding: 15px; background: white; border-radius: 8px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4 style="margin: 0 0 10px 0; color: #666; font-size: 14px;">ë¶„ì„ ì¼ì‹œ</h4>
                    <p style="margin: 0; font-size: 12px; color: #333;" th:text="${#temporals.format(analysisDate, 'yyyy-MM-dd HH:mm')}"></p>
                </div>
            </div>
        </div>
    </section>

    <!-- í¼ìŠ¤ë„ ì»¬ëŸ¬ íƒ€ì…ë³„ íŠ¹ì§•: ì´ˆê¸° ìˆ¨ê¹€ -->
    <section id="toneSection" class="charts-section hidden">
        <h2>í¼ìŠ¤ë„ ì»¬ëŸ¬ ì¶”ì²œ</h2>
        <div id="toneDescriptionBox"></div>
    </section>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="navigation-buttons" style="margin-top: 40px; display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
        <button onclick="window.location.href='/upload'"
                style="padding: 12px 24px; background: #fff; color: #333; border: 2px solid #333; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; font-size: 14px;">
            â† ìƒˆë¡œìš´ ë¶„ì„í•˜ê¸°
        </button>
        <button onclick="goToShopping()"
                style="padding: 12px 24px; background: #333; color: #fff; border: 2px solid #333; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; font-size: 14px;">
            ì‡¼í•‘í•˜ëŸ¬ ê°€ê¸° â†’
        </button>
    </div>
</div>

<script>
    function goToShopping() {
        const analysisId = /*[[${analysis.id}]]*/ null;
        if (analysisId) {
            window.location.href = '/shop?analysisId=' + analysisId;
        } else {
            window.location.href = '/shop';
        }
    }
</script>

<script th:inline="javascript">
    // ì´ˆê¸° ì°¨íŠ¸/ìƒ‰ìƒ ê¸°ëŠ¥ ìœ ì§€
    document.addEventListener('DOMContentLoaded', () => {
        const clothMaskUrl  = "/static/masks/";
        const personMaskUrl = "/static/pmasks/";
        initializeColorChangeFunctionality(clothMaskUrl, personMaskUrl);

        if (typeof Chart !== 'undefined') {
            initializeCharts();
        } else {
            const checkChart = setInterval(() => {
                if (typeof Chart !== 'undefined') { clearInterval(checkChart); initializeCharts(); }
            }, 100);
            setTimeout(() => { if (typeof Chart === 'undefined') { clearInterval(checkChart); console.error('Chart.js ë¡œë“œ ì‹¤íŒ¨'); showChartError(); } }, 5000);
        }

        // í† ê¸€ ë²„íŠ¼
        const detail = document.getElementById('detailSection');
        const tone   = document.getElementById('toneSection');

        const openDetailBtn  = document.getElementById('openDetailBtn');
        const closeDetailBtn = document.getElementById('closeDetailBtn');
        const openToneBtn    = document.getElementById('openToneBtn');
        const closeToneBtn   = document.getElementById('closeToneBtn');

        function show(el) { el && el.classList.remove('hidden'); }
        function hide(el) { el && el.classList.add('hidden'); }

        openDetailBtn?.addEventListener('click', () => {
            show(detail);
            hide(openDetailBtn);
            show(closeDetailBtn);
        });
        closeDetailBtn?.addEventListener('click', () => {
            hide(detail);
            show(openDetailBtn);
            hide(closeDetailBtn);
        });

        openToneBtn?.addEventListener('click', () => {
            show(tone);
            setToneDescription();
            hide(openToneBtn);
            show(closeToneBtn);
        });
        closeToneBtn?.addEventListener('click', () => {
            hide(tone);
            show(openToneBtn);
            hide(closeToneBtn);
        });

        // ë‚´ë¶€ ë‹«ê¸° ë²„íŠ¼ì—ì„œ ì„¹ì…˜ ë‹«ê¸° ì—°ê²°
        window.closeToneDescription = function() {
            hide(tone);
            show(openToneBtn);
            hide(closeToneBtn);
        };
    });

    // Chart.js ì´ˆê¸°í™” í•¨ìˆ˜ (ê¸°ì¡´ ì½”ë“œ ìš”ì•½, ìƒì„¸ êµ¬í˜„ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ ê°€ëŠ¥)
    function initializeCharts() {
        createConfidenceChart();
        createTypeComparisonChart();
    }
    function createConfidenceChart() {
        const ctx = document.getElementById('confidenceChart');
        if (!ctx) return;
        const confidence = /*[[${confidence}]]*/ 0;
        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['ì‹ ë¢°ë„', 'ë¶ˆí™•ì‹¤ì„±'],
                datasets: [{
                    data: [confidence, 100 - confidence],
                    backgroundColor: [
                        confidence > 70 ? '#4CAF50' : confidence > 50 ? '#FF9800' : '#F44336',
                        '#E0E0E0'
                    ],
                    borderWidth: 2,
                    borderColor: '#fff'
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
        });
    }
    function createTypeComparisonChart() {
        const ctx = document.getElementById('typeComparisonChart');
        if (!ctx) return;
        const probabilities = /*[[${probabilities}]]*/ {};
        const labels = ['SPRING', 'SUMMER', 'AUTUMN', 'WINTER'];
        const typeLabels = ['ë´„ ì›œí†¤', 'ì—¬ë¦„ ì¿¨í†¤', 'ê°€ì„ ì›œí†¤', 'ê²¨ìš¸ ì¿¨í†¤'];
        const data = labels.map(label => probabilities[label] || 0);
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: typeLabels,
                datasets: [{
                    label: 'ìœ ì‚¬ë„ (%)',
                    data: data,
                    fill: true,
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(54, 162, 235, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: { r: { beginAtZero: true, max: 100, ticks: { stepSize: 20 } } },
                plugins: { legend: { position: 'bottom' } }
            }
        });
    }
    function showChartError() {
        const chartContainers = document.querySelectorAll('.chart-container');
        chartContainers.forEach(container => {
            const canvas = container.querySelector('canvas');
            if (canvas) {
                canvas.style.display = 'none';
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'display:flex;align-items:center;justify-content:center;height:100%;color:#666;font-size:14px;';
                errorDiv.textContent = 'ì°¨íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                container.appendChild(errorDiv);
            }
        });
    }

    // ì´ë¯¸ì§€ ì»¬ëŸ¬ ë³€ê²½ ì‹œìŠ¤í…œ (ê¸°ì¡´ í•¨ìˆ˜ ìœ ì§€)
    function initializeColorChangeFunctionality(clothUrl, personUrl) {
        const resultImage = document.getElementById('resultImage');
        const canvas = document.getElementById('canvasOverlay');
        const ctx = canvas.getContext('2d');
        const swatches = document.querySelectorAll('.color-swatch');
        let originalImageData = null;
        let clothData = null;
        let personData = null;

        function setupCanvas() {
            canvas.width = resultImage.offsetWidth;
            canvas.height = resultImage.offsetHeight;
            ctx.drawImage(resultImage, 0, 0, canvas.width, canvas.height);
            originalImageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            if (clothUrl) loadMask(clothUrl, data => clothData = data);
            if (personUrl) loadMask(personUrl, data => personData = data);
        }
        resultImage.onload = setupCanvas;
        if (resultImage.complete) setupCanvas();

        function loadMask(maskUrl, callback) {
            const maskImg = new Image();
            maskImg.crossOrigin = 'anonymous';
            maskImg.onload = function() {
                const maskCanvas = document.createElement('canvas');
                const maskCtx = maskCanvas.getContext('2d');
                maskCanvas.width = canvas.width;
                maskCanvas.height = canvas.height;
                maskCtx.drawImage(maskImg, 0, 0, canvas.width, canvas.height);
                const maskData = maskCtx.getImageData(0, 0, canvas.width, canvas.height);
                callback(maskData.data);
            };
            maskImg.src = maskUrl;
        }

        swatches.forEach(swatch => {
            swatch.addEventListener('click', function() {
                swatches.forEach(s => s.classList.remove('selected'));
                this.classList.add('selected');
                const color = hexToRgb(swatch.dataset.color || swatch.style.backgroundColor);
                applyColorToClothing(color);
            });
        });

        function applyColorToClothing(colorHex) {
            if (!originalImageData) return;
            const imageData = ctx.createImageData(originalImageData);
            const data = imageData.data;
            const originalData = originalImageData.data;
            const rgb = hexToRgb(colorHex);
            if (!rgb) return;

            for (let i = 0; i < data.length; i += 4) {
                const maskCloth = clothData && clothData[i] > 128;
                const maskPerson = personData && personData[i] > 128;

                if (maskCloth) {
                    data[i]     = Math.min(255, originalData[i]     * rgb.r / 128);
                    data[i + 1] = Math.min(255, originalData[i + 1] * rgb.g / 128);
                    data[i + 2] = Math.min(255, originalData[i + 2] * rgb.b / 128);
                    data[i + 3] = originalData[i + 3];
                } else if (maskPerson) {
                    data[i] = 255; data[i + 1] = 255; data[i + 2] = 255; data[i + 3] = originalData[i + 3];
                } else {
                    data[i]     = originalData[i];
                    data[i + 1] = originalData[i + 1];
                    data[i + 2] = originalData[i + 2];
                    data[i + 3] = originalData[i + 3];
                }
            }
            ctx.putImageData(imageData, 0, 0);
        }

        function hexToRgb(input) {
            if (input && typeof input === 'object' && input.r !== undefined) return input;
            if (typeof input !== 'string') return null;
            if (input.startsWith('rgb')) {
                const match = input.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
                return match ? { r: parseInt(match[1]), g: parseInt(match[2]), b: parseInt(match[3]) } : null;
            }
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(input);
            return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null;
        }

        window.addEventListener('resize', function() {
            if (originalImageData) { setTimeout(setupCanvas, 100); }
        });
    }

    // ìš”ì²­í•œ setToneDescription ì‚½ì…
    function setToneDescription() {
        const rawType = ('[[${analysis.colorType}]]' || '').toString().toLowerCase();
        const norm = rawType.includes('spring') ? 'spring'
            : rawType.includes('summer') ? 'summer'
                : rawType.includes('autumn') ? 'autumn'
                    : rawType.includes('winter') ? 'winter'
                        : '';

        const box = document.getElementById("toneDescriptionBox");
        const toneDescriptions = {
            "spring": {
                ì´ë¦„: "ğŸŒ¸ ë´„ ì›œí†¤",
                íŠ¹ì§•: "ë°ê³  íˆ¬ëª…, ë”°ëœ»í•˜ê³  ìƒê¸° ìˆëŠ” ì»¬ëŸ¬.",
                ì¶”ì²œ: "ë¼ì´íŠ¸ ì˜ë¡œìš°, ì•„ì´ë³´ë¦¬, í¬ë¦¼ ë² ì´ì§€ / ì½”ë„, í”¼ì¹˜, ì‚´ëª¬ í•‘í¬ / ë¯¼íŠ¸, ì•„ì¿ ì•„, í„°í‚¤ì˜¥",
                í”¼í•´ì•¼: "ë¸”ë™, ë‹¤í¬ë¸Œë¼ìš´, ë„¤ì´ë¹„ / í‘¸ë¥¸ ë³´ë¼, ì•„ì´ì‹œ ë¸”ë£¨",
                í—¤ì–´: "ë¼ì´íŠ¸ ë¸Œë¼ìš´, í—ˆë‹ˆ ë¸Œë¼ìš´, ê³¨ë“œ ë¸Œë¼ìš´",
                ë©”ì´í¬ì—…: "ì½”ë„/í”¼ì¹˜ ë¦½, ì˜¤ë Œì§€ ë¸Œë¼ìš´ ì„€ë„, ê³¨ë“œ í„ í•˜ì´ë¼ì´í„°"
            },
            "summer": {
                ì´ë¦„: "ğŸŒŠ ì—¬ë¦„ ì¿¨í†¤",
                íŠ¹ì§•: "ì°¨ë¶„í•˜ê³  ë¶€ë“œëŸ¬ìš´ íŒŒìŠ¤í…”í†¤, íë¦¿í•˜ê³  ì†Œí”„íŠ¸í•œ ì»¬ëŸ¬.",
                ì¶”ì²œ: "ë¼ë²¤ë”, ì†Œí”„íŠ¸ í•‘í¬, ë² ì´ë¹„ ë¸”ë£¨, ë¯¼íŠ¸ / ì¿¨ ê·¸ë ˆì´, í“¨ì–´ í™”ì´íŠ¸ / ì²´ë¦¬ í•‘í¬, ë¡œì¦ˆ, ë”¥ ë¼ì¦ˆë² ë¦¬",
                í”¼í•´ì•¼: "ë¨¸ìŠ¤í„°ë“œ, ì˜¬ë¦¬ë¸Œ, ì˜¤ë Œì§€ ë ˆë“œ / ë¸”ë™ì²˜ëŸ¼ ê°•í•œ ëŒ€ë¹„ ìƒ‰ìƒ",
                í—¤ì–´: "ì• ì‰¬ ë¸Œë¼ìš´, ì†Œí”„íŠ¸ ë¸”ë™, ë„¤ì´ë¹„ ë¸”ë™",
                ë©”ì´í¬ì—…: "ë¡œì¦ˆ/í•‘í¬ ë¦½, ë¼ë²¤ë”Â·ì¿¨ë¸Œë¼ìš´ ì„€ë„, ì‹¤ë²„ í„"
            },
            "autumn": {
                ì´ë¦„: "ğŸ ê°€ì„ ì›œí†¤",
                íŠ¹ì§•: "ê¹Šê³  ê·¸ìœ½í•˜ë©° ë”°ëœ»í•œ ê°€ì„ ìˆ²Â·ëŒ€ì§€ ìƒ‰.",
                ì¶”ì²œ: "ë¨¸ìŠ¤í„°ë“œ, ì¹´ë©œ, ì½”ì½”ì•„, ì´ˆì½œë¦¿ ë¸Œë¼ìš´ / í…Œë¼ì½”íƒ€, ë¸Œë¦­ ë ˆë“œ, ë²„ê±´ë”” / ì˜¬ë¦¬ë¸Œ, ì¹´í‚¤, í¬ë ˆìŠ¤íŠ¸ ê·¸ë¦°",
                í”¼í•´ì•¼: "íŒŒìŠ¤í…”í†¤, í“¨ì–´ í™”ì´íŠ¸, í˜•ê´‘ìƒ‰",
                í—¤ì–´: "ë‹¤í¬ ë¸Œë¼ìš´, ëª¨ì¹´, ë ˆë“œ ë¸Œë¼ìš´",
                ë©”ì´í¬ì—…: "ë¸Œë¦­Â·í…Œë¼ì½”íƒ€ ë¦½, ë¸Œë¡ ì¦ˆ ì„€ë„, ê³¨ë“œ í„"
            },
            "winter": {
                ì´ë¦„: "â„ ê²¨ìš¸ ì¿¨í†¤",
                íŠ¹ì§•: "ì„ ëª…í•˜ê³  ì°¨ê°‘ê³  ê°•í•œ ëŒ€ë¹„, ê³ ì±„ë„ & ë”¥ ì»¬ëŸ¬.",
                ì¶”ì²œ: "ë¸”ë™, í“¨ì–´ í™”ì´íŠ¸ / í‘¸ì‹œì•„, ë”¥ ë ˆë“œ, ì²´ë¦¬, ë£¨ë¹„ / ì½”ë°œíŠ¸ ë¸”ë£¨, ì—ë©”ë„ë“œ, í¼í”Œ",
                í”¼í•´ì•¼: "ë¨¸ìŠ¤í„°ë“œ, ì¹´ë©œ, ì˜¤ë Œì§€ / í†¤ ë‹¤ìš´ëœ ë² ì´ì§€, ì˜¬ë¦¬ë¸Œ",
                í—¤ì–´: "ë¸”ë™, ë¸”ë£¨ë¸”ë™, ë‹¤í¬ ì• ì‰¬",
                ë©”ì´í¬ì—…: "ë ˆë“œ/í‘¸ì‹œì•„ ë¦½, ìŠ¤ëª¨í‚¤ ë¸”ë™ ì•„ì´, í™”ì´íŠ¸ í•˜ì´ë¼ì´í„°"
            }
        };

        if (!box) return;
        const tone = toneDescriptions[norm];
        if (!tone) {
            box.innerHTML = "<p>ì¶”ì²œ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
            return;
        }

        box.innerHTML = `
            <button type="button" class="close-btn" onclick="closeToneDescription()">ì¶”ì²œ ë‹«ê¸°</button>
            <h3>${tone.ì´ë¦„}</h3>
            <p><b>íŠ¹ì§•:</b> ${tone.íŠ¹ì§•}</p>
            <p><b>ì¶”ì²œ ìƒ‰ìƒ:</b> ${tone.ì¶”ì²œ}</p>
            <p><b>í”¼í•´ì•¼ í•  ìƒ‰ìƒ:</b> ${tone.í”¼í•´ì•¼}</p>
            <p><b>í—¤ì–´ ìƒ‰ìƒ:</b> ${tone.í—¤ì–´}</p>
            <p><b>ë©”ì´í¬ì—…:</b> ${tone.ë©”ì´í¬ì—…}</p>
        `;
    }
</script>
</body>
</html>
